<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>StreamDeck Lite</title>

  <!-- iOS "web app" mode -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <meta name="apple-mobile-web-app-title" content="StreamDeck" />

  <meta name="theme-color" content="#ffffff" />
  <link rel="stylesheet" href="styles.css" />

  <!-- Fallback favicon; iOS prendra une capture si pas d'icône PNG dédiée -->
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 128 128'%3E%3Crect rx='24' width='128' height='128' fill='%23f4f6f8'/%3E%3Ccircle cx='64' cy='64' r='36' fill='%23007aff'/%3E%3Cpath d='M82 64c0 9.94-8.06 18-18 18s-18-8.06-18-18 8.06-18 18-18 18 8.06 18 18z' fill='%23fff' opacity='.9'/%3E%3C/svg%3E">

  <!-- Empêche zoom à deux doigts pendant le swipe horizontal -->
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
</head>
<body>
  <header class="app-header">
    <div class="logo">
      <!-- petit logo pour une belle capture d'icône -->
      <svg width="24" height="24" viewBox="0 0 128 128" aria-hidden="true">
        <rect rx="24" width="128" height="128" fill="#f4f6f8"></rect>
        <circle cx="64" cy="64" r="36" fill="#007aff"></circle>
        <path d="M82 64c0 9.94-8.06 18-18 18s-18-8.06-18-18 8.06-18 18-18 18 8.06 18 18z" fill="#fff" opacity=".9"></path>
      </svg>
      <span>StreamDeck</span>
    </div>
  </header>

  <main id="slides" class="slides" tabindex="0" aria-label="Panneaux glissables">
    <!-- Slide 1: Lecteur -->
    <section class="slide" aria-labelledby="player-title">
      <h1 id="player-title">Lecteur</h1>

      <div class="player-card card">
        <div class="now-meta">
          <div class="title" id="nowName">Aucun flux</div>
          <div class="url" id="nowUrl">—</div>
        </div>

        <audio id="audio" preload="none" playsinline></audio>

        <div class="controls">
          <button id="playPause" class="btn primary" disabled>Lecture</button>
          <button id="stopBtn" class="btn" disabled>Stop</button>
          <label class="vol">
            Volume
            <input id="volume" type="range" min="0" max="1" step="0.01" value="1" />
          </label>
        </div>

        <div class="extras">
          <label class="mui-switch"><input type="checkbox" id="autoResume"> Reprendre automatiquement le dernier flux</label>
          <label class="mui-switch"><input type="checkbox" id="showLockInfo"> Afficher titre sur l’écran verrouillé</label>
          <div class="sleep">
            Minuteur sommeil (min) :
            <input id="sleepMinutes" type="number" min="0" max="240" step="5" value="0" />
            <button id="sleepStart" class="btn">Démarrer</button>
            <span id="sleepLeft" class="muted"></span>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-head">
          <h2>Vos flux</h2>
          <button id="addQuick" class="btn small">+ ajout rapide</button>
        </div>
        <ul id="streamList" class="stream-list" aria-live="polite"></ul>
      </div>
    </section>

    <!-- Slide 2: Gestion des flux -->
    <section class="slide" aria-labelledby="library-title">
      <h1 id="library-title">Gestion des flux</h1>

      <div class="card">
        <form id="streamForm" class="grid">
          <input type="hidden" id="streamId" />
          <label>Nom
            <input id="streamName" type="text" placeholder="ex. FIP hifi" required />
          </label>
          <label>URL
            <input id="streamUrl" type="url" placeholder="http(s)://..." required />
          </label>
          <label>Format (optionnel)
            <select id="streamFormat">
              <option value="">Auto</option>
              <option value="mp3">MP3</option>
              <option value="aac">AAC</option>
            </select>
          </label>
          <label class="mui-switch"><input id="streamFav" type="checkbox" /> Favori</label>
          <label>Notes
            <input id="streamNotes" type="text" placeholder="bitrate, origine..." />
          </label>

          <div class="row">
            <button type="submit" class="btn primary" id="saveStream">Enregistrer</button>
            <button type="button" class="btn" id="resetForm">Nouveau</button>
            <button type="button" class="btn danger" id="deleteStream" disabled>Supprimer</button>
          </div>
        </form>
      </div>

      <div class="card">
        <div class="card-head">
          <h2>Liste & organisation</h2>
          <div class="row">
            <button id="exportJson" class="btn small">Exporter JSON</button>
            <label class="btn small file-btn">Importer JSON
              <input id="importJson" type="file" accept="application/json" hidden />
            </label>
          </div>
        </div>
        <ul id="manageList" class="manage-list"></ul>
      </div>
    </section>

    <!-- Slide 3: Avancé -->
    <section class="slide" aria-labelledby="settings-title">
      <h1 id="settings-title">Options avancées</h1>

      <div class="card">
        <h2>Réseau & compatibilité iOS</h2>
        <label class="mui-switch"><input type="checkbox" id="tryHttp"> Essayer le HTTP si HTTPS échoue</label>
        <p class="muted">
          Sur une page <strong>HTTPS</strong>, les flux <code>http://</code> sont bloqués par iOS.
          Servez cette appli en <strong>HTTP</strong> (réseau local) pour lire ces flux, ou utilisez le bouton
          “Ouvrir dans Safari” proposé en cas d’échec.
        </p>
      </div>

      <div class="card">
        <h2>Interface</h2>
        <label class="mui-switch"><input type="checkbox" id="compactList"> Liste compacte</label>
        <label class="mui-switch"><input type="checkbox" id="haptics"> Retour haptique (si dispo)</label>
      </div>

      <div class="card">
        <h2>Divers</h2>
        <button id="seedDemo" class="btn small">Insérer des exemples (FIP, etc.)</button>
        <button id="nukeAll" class="btn danger small">Tout réinitialiser</button>
        <p class="muted">Version <span id="appVersion"></span></p>
      </div>
    </section>
  </main>

  <footer class="app-footer">
    <nav class="pager" id="pager">
      <button id="toPlayer" aria-label="Lecteur" class="active">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M3 12l9-9 9 9"/>
          <path d="M9 21V9h6v12"/>
        </svg>
      </button>
      <button id="toLibrary" aria-label="Bibliothèque">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="4" width="18" height="18" rx="2"/>
          <path d="M3 10h18M10 4v18"/>
        </svg>
      </button>
      <button id="toSettings" aria-label="Réglages">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="3"/>
          <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 1 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V22a2 2 0 1 1-4 0v-.09a1.65 1.65 0 0 0-1-1.51 1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 1 1-2.83-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H2a2 2 0 1 1 0-4h.09a1.65 1.65 0 0 0 1.51-1 1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 1 1 2.83-2.83l.06.06a1.65 1.65 0 0 0 1.82.33h.09A1.65 1.65 0 0 0 9 3.09V3a2 2 0 1 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 1 1 2.83 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82v.09a1.65 1.65 0 0 0 1.51 1H22a2 2 0 1 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/>
        </svg>
      </button>
    </nav>
  </footer>

  <script src="app.js"></script>
</body>
</html>
